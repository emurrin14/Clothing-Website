{% extends "clothesshop/base.html" %}
{% load static %}

{% block title %}{{ listing.title }} - Clothesshop{% endblock %}

{% block content %}
  <!-- product img grid -->
  <div class="center-row-flex">
    <section class="grid2" aria-label="Gallery of images">

      <figure class="card2">
        <div>
          {% if listing.primary_image %}
          <img src="{{ listing.primary_image.url }}" alt="Primary image for {{ listing.title }}">
          {% else %}
          <div class="no-image">No Primary Image</div>
          {% endif %}

          {% if listing.secondary_image %}
          <img src="{{ listing.secondary_image.url }}" alt="Secondary image for {{ listing.title }}">
          {% endif %}
        </div>
      </figure>

    </section>
    <div class="productinfo">
      <div class="product-title prod-title">{{ listing.title }}</div>
      <div class="price">${{ listing.price }}</div>
      <div class="description">{{ listing.description|linebreaks }}</div>
      
      <!-- Add to Cart Form -->
      <form action="{% url 'add_to_cart' listing.id %}" method="post" class="add-to-cart-form">
        {% csrf_token %}
        {% if listing.stock_items.all %}
          <div class="size-selector">
            <label for="size">Size:</label>
            <select name="size" id="size" required>
              <option value="" disabled selected>Select a size</option>
              {% for stock_item in listing.stock_items.all %}
                <option value="{{ stock_item.size }}">{{ stock_item.size }}</option>
              {% endfor %}
            </select>
          </div>
        {% endif %}
        <button type="submit" class="button add-to-cart-btn">Add to Cart</button>
      </form>
    </div>
  </div>
{% endblock %}